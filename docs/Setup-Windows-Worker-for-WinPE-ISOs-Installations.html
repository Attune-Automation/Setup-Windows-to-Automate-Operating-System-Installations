
<!doctype html>
<html lang="en">




<head>
    <title>How to Setup Windows Worker for WinPE ISOs Installations - Attune Automation</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="title"
          content="How to Setup Windows Worker for WinPE ISOs Installations - Attune Automation">
    <meta name="description"
          content="The scripts within each step automate the Windows worker setup for automating 
Windows installation using WinPE ISOs.

# Install Windows Assessment and Deployment Kit (ADK)
Download and install the appropriate ADK and WinPE Add-On version based on the 
Windows distribution.

# Install Worker Prerequ">
    <meta name="robots"
          content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large">

    <meta property="og:locale" content="en_AU" />
    <meta property="og:type" content="article" />
    <meta property="og:title"
          content="HowTo Setup Windows Worker for WinPE ISOs Installations - Attune Automation" />
    <meta property="og:description" content="The scripts within each step automate the Windows worker setup for automating 
Windows installation using WinPE ISOs.

# Install Windows Assessment and Deployment Kit (ADK)
Download and install the appropriate ADK and WinPE Add-On version based on the 
Windows distribution.

# Install Worker Prerequ" />
    <meta property="og:site_name" content="Attune Automation" />
    <meta property="article:section" content="IT Instruction" />

    <meta name="twitter:title"
          content="How to Setup Windows Worker for WinPE ISOs Installations - Attune Automation" />
    <meta name="twitter:description" content="The scripts within each step automate the Windows worker setup for automating 
Windows installation using WinPE ISOs.

# Install Windows Assessment and Deployment Kit (ADK)
Download and install the appropriate ADK and WinPE Add-On version based on the 
Windows distribution.

# Install Worker Prerequ" />

    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-32x32.png" sizes="32x32">
    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-192x192.png" sizes="192x192">
    <link rel="apple-touch-icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-180x180.png">
    <meta name="msapplication-TileImage" content="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-270x270.png">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="styles/style.css">

    <!-- Google tag (gtag.js) -->
    <script async
            src="https://www.googletagmanager.com/gtag/js?id=G-5TZQZNDJCD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-5TZQZNDJCD');
    </script>
</head>


<body>

<!-- Project NavBar -->

<div class="bg-white border-bottom box-shadow sticky-top mb-3">
<div class="container px-0">
    <div class="row px-0">
        <div class="col d-flex flex-column flex-lg-row align-items-center px-0
            py-3">
            <a class="navbar-brand my-0 mr-lg-auto"
                  href="https://www.servertribe.com/"
                  target="_blank">
                    <img
                        src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                        alt="Attune - Powered by ServerTribe"
                        class="img-fluid navbar-img">
            </a>
            <nav class="my-2 my-lg-0 mr-lg-3">
                <a class="p-2 text-dark" href="http://doc.servertribe.com/"
                   target="_blank">
                    Documentation
                </a>
                <a class="p-2 text-dark"
                   href="https://discord.com/invite/3YpJsagqUn"
                   target="_blank">
                    Discord
                </a>
                <a class="p-2 text-dark" href="https://github.com/Attune-Automation"
                   target="_blank">
                    GitHub
                </a>
                <a class="p-2 text-dark" href="https://www.servertribe.com/learn/"
                   target="_blank">
                    Learn
                </a>
            </nav>
            <a class="btn btn-outline-primary"
               href="https://www.servertribe.com/download-attune-registration/"
               target="_blank">
                Download NOW!
            </a>
        </div>
    </div>
</div></div>

<!-- Project breadcrumbs -->

<!-- Project breadcrumbs -->
<div class="container px-0">
    <div class="row">
        <nav class="col px-0" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="index.html">
                    Setup Windows to Automate Operating System Installations
                    </a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                    <strong>Setup Windows Worker for WinPE ISOs Installations</strong>
                </li>
            </ol>
        </nav>
    </div>
</div>

<!-- Blueprint Header -->

<div class="container px-0">
    <!-- Blueprint name and description -->
    <div class="row">
        <div class="col px-0">
            <h1 class="text-left">
                How to Setup Windows Worker for WinPE ISOs Installations
            </h1>
        </div>
    </div>

<!-- Blueprint Description -->
    <div class="row">
        <div class="description col px-0">
            <p class="text-left">
                <p>The scripts within each step automate the Windows worker setup for automating 
Windows installation using WinPE ISOs.</p>
<h4>Install Windows Assessment and Deployment Kit (ADK)</h4>
<p>Download and install the appropriate ADK and WinPE Add-On version based on the 
Windows distribution.</p>
<h4>Install Worker Prerequisites on Windows</h4>
<p>Download and install 7z.</p>
<h4>Setup and Create SmbShare Folder on Windows</h4>
<p>Enable the File and Printer Sharing service, 
configure the firewall for Network Discovery, 
create an SMB share folder, and 
setup appropriate NTFS permissions.</p>
            </p>
        </div>
    </div>
    <div class="row pt-4">
        <div class="col-6 px-0">
            <h6 class="text-left">
                This documentation is generated by
                <a href="https://www.servertribe.com/"
                    class="badge badge-primary"
                    target="_blank">
                    Attune
                </a>
            </h6>
        </div>
        <div class="col-6 align-self-end text-right px-0">
            <h6 class="text-right">
                <a href="https://www.youtube.com/@servertribe"
                    class="badge badge-secondary"
                    target="_blank">
                    YouTube
                </a>
                <a href="https://github.com/Attune-Automation"
                    class="badge badge-secondary"
                    target="_blank">
                    GitHub
                </a>
                <a href="https://discord.com/invite/3YpJsagqUn"
                    class="badge badge-secondary"
                    target="_blank">
                    Discord
                </a>
                <a href="https://www.linkedin.com/company/servertribe/"
                    class="badge badge-secondary"
                    target="_blank">
                    LinkedIn
                </a>
                <a href="http://doc.servertribe.com/"
                    class="badge badge-secondary"
                    target="_blank">
                    Documentation
                </a>
            </h6>
        </div>
    </div>
    <hr>
</div>

<div class="documentation">
    <div class="container px-0">
        <div class="row">

<!-- Blueprint ToC -->


            <div class="toc col-lg-2 px-0 pr-5">
                <div class="container px-0 pt-3">
                    <p class="pb-2">
                        <strong>Contents</strong>
                    </p>
                    <p class="text-muted">
                        <a href="#top">
                            <strong>Setup Windows Worker for WinPE ISOs Installations</strong>
                        </a>
                    </p>


    
        

                    <p class="text-muted pt-2">
                        <a href="#installwindowsassessmentanddeploymentkit">
                            <strong>Step 1 -</strong> Install Windows Assessment and Deployment Kit
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#downloadadk">
                            <strong>Step 1.1 -</strong> Download ADK
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#installadk">
                            <strong>Step 1.2 -</strong> Install ADK
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#downloadwinpeaddonforadk">
                            <strong>Step 1.3 -</strong> Download WinPE Add-On for ADK
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#installwinpeaddonforadk">
                            <strong>Step 1.4 -</strong> Install WinPE Add-On for ADK
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#cleanuptheadkdownloadsfolder">
                            <strong>Step 1.5 -</strong> Cleanup the ADK Downloads Folder
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#installwindowsworkerprerequisites">
                            <strong>Step 2 -</strong> Install Windows Worker Prerequisites
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#downloadandinstall7z">
                            <strong>Step 2.1 -</strong> Download and Install 7z
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#download7z">
                            <strong>Step 2.1.1 -</strong> Download 7z
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#install7z">
                            <strong>Step 2.1.2 -</strong> Install 7z
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#cleanup7zinstaller">
                            <strong>Step 2.1.3 -</strong> Cleanup 7z Installer
                        </a>
                    </p>



        

                    <p class="text-muted pt-2">
                        <a href="#createasmbsharefolder">
                            <strong>Step 3 -</strong> Create a SMB Share folder
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#enablefileandprintersharingformicrosoftnetworksservice">
                            <strong>Step 3.1 -</strong> Enable File and Printer Sharing for Microsoft Networks service
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#enablefirewallrulenetworkdiscovery">
                            <strong>Step 3.2 -</strong> Enable Firewall Rule Network Discovery
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#createanewsmbsharefolder">
                            <strong>Step 3.3 -</strong> Create a new SMB Share folder
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#modifyntfspermissionforsmbsharefolder">
                            <strong>Step 3.4 -</strong> Modify NTFS permission for SmbShare folder
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#turnoffpasswordprotectedsharing">
                            <strong>Step 3.5 -</strong> Turn off Password Protected Sharing
                        </a>
                    </p>



                </div>
            </div>

<!-- Blueprint Contents -->
            <div class="col-lg-8 pt-3">
                <div class="container">


        <div class="jumbotron">
            <p class="display-3 text-center">
                <strong>Automate This</strong>
            </p>
            <p class="lead text-center">
                Use the <strong>Attune GUI</strong> for your Scripts
            </p>
            <p class="lead">
                <ol>
                    <a href="https://www.servertribe.com/download-attune-registration/"
                        target="_blank">
                        <span class="badge badge-primary">1</span>
                        Download Attune
                        <i class="fa-solid fa-download fa-beat-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://github.com/attune-Automation/"
                        target="_blank">
                        <span class="badge badge-primary">2</span>
                         Copy the Attune Project URL
                         <i class="fa-brands fa-github fa-fade"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://servertribe-attune.readthedocs.io/en/latest/howto/design_workspace/clone_project.html"
                        target="_blank">
                        <span class="badge badge-primary">3</span>
                        Clone the Project in Attune
                         <i class="fa-solid fa-book fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=GCWDI29rDV0"
                        target="_blank">
                        <span class="badge badge-primary">4</span>
                        Plan your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=b7DhFcURkZg"
                        target="_blank">
                        <span class="badge badge-primary">5</span>
                        Run your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
            </p>
            <p class="lead text-center">
                You've automated: <strong>Setup Windows Worker for WinPE ISOs Installations</strong>
            </p>
            <hr class="my-4 text-center">
            <div class="col px-0">
                <p class="text-center">
                    Get the most out of automation with our get started
                    videos, product demonstrations, and more.
                </p>
                <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://www.servertribe.com/learn/"
                       target="_blank"
                       role="button">
                        Learn Attune Automation
                    </a>
                </p>
            </div>
        </div>

        <div class="row">
            <p>The following steps will guide you through the manual process.</p>
        </div>

<!-- Blueprint Steps -->


        



                    <div class="row pt-5">
                        <h3 id="installwindowsassessmentanddeploymentkit">
                            <a href="#installwindowsassessmentanddeploymentkit">
                                <strong>Step 1 -</strong> Install Windows Assessment and Deployment Kit
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>The Windows Assessment and Deployment Kit (Windows ADK) and 
Windows PE add-on has the tools you need to customise 
Windows images for large-scale deployment, and to test 
the quality and performance of your system, its added 
components, and the applications running on it.</p>
<p><a href="https://learn.microsoft.com/en-us/windows-hardware/get-started/adk-install">Microsoft Documentation</a></p>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="downloadadk">
                            <a href="#downloadadk">
                                <strong>Step 1.1 -</strong> Download ADK
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Use the ADK version that matches the Windows version 
you are working with. If your environment has a mix of 
Windows versions, use the ADK version that matches the 
latest operating system in your environment.</p>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via RDP:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
mstsc /admin /v:{automationworkerwindowsnode}
                            </code>
                        </div>
                        <div class="row">
                            <p>
                                Login as user {automationworkerwindowsuseradministrator} and open a
                                command prompt.
                            </p>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
# Get the OS information
$OS = Get-WmiObject Win32_OperatingSystem

$ADK_DOWNLOADS=&quot;C:\software\ADKDownloads&quot;

if ( -Not (Test-Path &quot;${ADK_DOWNLOADS}&quot;) ) {
  New-Item &quot;${ADK_DOWNLOADS}&quot; -ItemType Directory
}

Set-Location &quot;${ADK_DOWNLOADS}&quot;

$adkPath = &quot;C:\Program Files (x86)\Windows Kits\10\Assessment and Deployment Kit&quot;

if (Test-Path $adkPath) {
    Write-Host &quot;Windows ADK is installed.&quot;
    exit 0
}

# Check the caption property for Windows Server 2022 or Windows 11
if ($OS.Caption -like &quot;*Windows Server 2022*&quot;) {
    
    Write-Host &quot;This system is running Windows Server 2022&quot;
    $ADK_WIN2022_URL=&quot;https://go.microsoft.com/fwlink/?linkid=2162950&quot;
    $ProgressPreference = &#x27;SilentlyContinue&#x27;
    Invoke-WebRequest $ADK_WIN2022_URL -OutFile &quot;./adksetup.exe&quot; -Verbose
    Get-ChildItem -Path &quot;${ADK_DOWNLOADS}&quot; -Recurse
    
} elseif ($OS.Caption -like &quot;*Windows 11*&quot;) {
    
    Write-Host &quot;This system is running Windows 11&quot;
    $ADK_WIN11_URL=&quot;https://go.microsoft.com/fwlink/?linkid=2165884&quot;
    $ProgressPreference = &#x27;SilentlyContinue&#x27;
    Invoke-WebRequest $ADK_WIN11_URL -OutFile &quot;./adksetup.exe&quot; -Verbose
    Get-ChildItem -Path &quot;${ADK_DOWNLOADS}&quot; -Recurse
    
} else {
    
    Write-Error &quot;This system is not running Windows Server 2022 or Windows 11&quot;
    
}
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="installadk">
                            <a href="#installadk">
                                <strong>Step 1.2 -</strong> Install ADK
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Run <code>adksetup.exe</code></p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$ADK=&quot;C:\software\ADKDownloads&quot;
$adkInstalled = $false

Set-Location &quot;${ADK}&quot;

$adkPath = &quot;C:\Program Files (x86)\Windows Kits\10\Assessment and Deployment Kit&quot;

if (Test-Path $adkPath) {
    Write-Host &quot;Windows ADK is installed.&quot;
    exit 0
} else {
    Write-Host &quot;Installing ADK...&quot;
    ./adksetup.exe /quiet `
        /features OptionId.DeploymentTools  `
        /norestart `
        /log adk_install_log.txt `
        /ceip off
}

# Loop until ADK is installed
while (-not $adkInstalled) {
    if (Test-Path -Path $adkPath) {
        Write-Host &quot;Windows ADK is installed.&quot;
        $adkInstalled = $true
        exit 0
    } else {
        Start-Sleep -Seconds 5
    }
}
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="downloadwinpeaddonforadk">
                            <a href="#downloadwinpeaddonforadk">
                                <strong>Step 1.3 -</strong> Download WinPE Add-On for ADK
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Use the ADK version that matches the Windows version you are working with. If your environment has a mix of Windows versions, use the ADK version that matches the latest operating system in your environment.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
# Get the OS information
$OS = Get-WmiObject Win32_OperatingSystem

$ADK_DOWNLOADS=&quot;C:\software\ADKDownloads&quot;

if ( -Not (Test-Path &quot;${ADK_DOWNLOADS}&quot;) ) {
  New-Item &quot;${ADK_DOWNLOADS}&quot; -ItemType Directory
}

Set-Location &quot;${ADK_DOWNLOADS}&quot;

$winPEPath = &quot;C:\Program Files (x86)\Windows Kits\10\Assessment and Deployment Kit\Windows Preinstallation Environment&quot;

if (Test-Path $winPEPath) {
    Write-Host &quot;WinPE add-on for ADK is installed.&quot;
    exit 0
}

# Check the caption property for Windows Server 2022 or Windows 11
if ($OS.Caption -like &quot;*Windows Server 2022*&quot;) {
    
    Write-Host &quot;This system is running Windows Server 2022&quot;
    $ADK_WIN2022_URL=&quot;https://go.microsoft.com/fwlink/?linkid=2163233&quot;
    $ProgressPreference = &#x27;SilentlyContinue&#x27;
    Invoke-WebRequest $ADK_WIN2022_URL -OutFile &quot;./adk_winpe_add_on.exe&quot; -Verbose
    Get-ChildItem -Path &quot;${ADK_DOWNLOADS}&quot; -Recurse
    
} elseif ($OS.Caption -like &quot;*Windows 11*&quot;) {
    
    Write-Host &quot;This system is running Windows 11&quot;
    $ADK_WIN11_URL=&quot;https://go.microsoft.com/fwlink/?linkid=2166133&quot;
    $ProgressPreference = &#x27;SilentlyContinue&#x27;
    Invoke-WebRequest $ADK_WIN11_URL -OutFile &quot;./adk_winpe_add_on.exe&quot; -Verbose
    Get-ChildItem -Path &quot;${ADK_DOWNLOADS}&quot; -Recurse
    
} else {
    
    Write-Error &quot;This system is not running Windows Server 2022 or Windows 11&quot;
    
}
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="installwinpeaddonforadk">
                            <a href="#installwinpeaddonforadk">
                                <strong>Step 1.4 -</strong> Install WinPE Add-On for ADK
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Run <code>adk_winpe_add_on.exe</code></p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$ADK=&quot;C:\software\ADKDownloads&quot;
$adkInstalled = $false

Set-Location &quot;${ADK}&quot;
    
$winPEPath = &quot;C:\Program Files (x86)\Windows Kits\10\Assessment and Deployment Kit\Windows Preinstallation Environment&quot;

if (Test-Path $winPEPath) {
    Write-Host &quot;WinPE add-on for ADK is installed.&quot;
    exit 0
} else {
    Write-Host &quot;Installing ADK WinPE add-on...&quot;
    ./adk_winpe_add_on.exe /quiet `
        /features OptionId.WindowsPreinstallationEnvironment `
        /norestart `
        /log adk_winpe_add_on_install_log.txt `
        /ceip off
}

# Loop until ADK is installed
while (-not $adkInstalled) {
    if (Test-Path -Path $winPEPath) {
        Write-Host &quot;Windows ADK WinPE add-on is installed.&quot;
        $adkInstalled = $true
        exit 0
    } else {
        Start-Sleep -Seconds 5
    }
}
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="cleanuptheadkdownloadsfolder">
                            <a href="#cleanuptheadkdownloadsfolder">
                                <strong>Step 1.5 -</strong> Cleanup the ADK Downloads Folder
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Delete the <code>ADKDownloads</code> directory.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
Set-Location &quot;C:\software\&quot;

$ADKDownloads = &quot;ADKDownloads&quot;

if (Test-Path &quot;${ADKDownloads}&quot;) {
    Remove-Item -Recurse &quot;.\${ADKDownloads}&quot; -Verbose
}
                </code>
            </pre>
        </div>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="installwindowsworkerprerequisites">
                            <a href="#installwindowsworkerprerequisites">
                                <strong>Step 2 -</strong> Install Windows Worker Prerequisites
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Install dependencies required for the worker to function.</p>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="downloadandinstall7z">
                            <a href="#downloadandinstall7z">
                                <strong>Step 2.1 -</strong> Download and Install 7z
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Download and install 7-zip. 7-zip is used to extract ISO files.</p>
<p><a href="https://7-zip.org/">7-zip documentation</a></p>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h5 id="download7z">
                            <a href="#download7z">
                                <strong>Step 2.1.1 -</strong> Download 7z
                            </a>
                        </h5>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Download the 7-zip installer.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
try {
    
    $softwareName = &quot;7-Zip&quot;
    $windowsRegistry = (Get-ItemProperty &quot;HKLM:\SOFTWARE\$softwareName&quot;).Path
    
    if (-not $windowsRegistry) {
        throw &quot;Not found in registry.&quot;
    }
    Write-Host &quot;Already installed at $windowsRegistry&quot;

} catch {
    
    try {
        
        $installerFile = &quot;7z2301-x64.msi&quot;
        $url = &quot;https://www.7-zip.org/a/$installerFile&quot;
        $softwareFolder = &quot;C:\software&quot;
        $downloadPath = Join-Path -Path $softwareFolder -ChildPath $installerFile
        
        if (-not (Test-Path -Path $downloadPath)) {
            throw &quot;Download installer.&quot;
        }
        
        Write-Host &quot;Installer already downloaded at: $downloadPath&quot;
        
    } catch {
        
        if (-not (Test-Path -Path $softwareFolder)) {
            New-Item -ItemType Directory -Path $softwareFolder
        }
    
        Write-Host &quot;Downloading from $url&quot;
        Invoke-WebRequest -Uri $url -OutFile $downloadPath
    
        if (Test-Path -Path $downloadPath) {
            Write-Host &quot;Installer download successful.&quot;
        } else {
            Write-Error &quot;Failed to download the installer.&quot;
        }
    }
}
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h5 id="install7z">
                            <a href="#install7z">
                                <strong>Step 2.1.2 -</strong> Install 7z
                            </a>
                        </h5>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Run the 7-zip msi installer.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
try {
    
    $softwareName = &quot;7-Zip&quot;
    $installerFile = &quot;7z2301-x64.msi&quot;
    $softwareFolder = &quot;C:\software&quot;
    $downloadPath = Join-Path -Path $softwareFolder -ChildPath $installerFile
    $windowsRegistry = (Get-ItemProperty &quot;HKLM:\SOFTWARE\$softwareName&quot;).Path
    
    if (-not $windowsRegistry) {
        throw &quot;Not found in registry.&quot;
    }
    Write-Host &quot;Already installed at $windowsRegistry&quot;
    
} catch {
    
    Write-Host &quot;Installing...&quot;

    if (Test-Path -Path $downloadPath) {
        Write-Host &quot;Installing from $downloadPath&quot;
        Start-Process msiexec.exe -ArgumentList &quot;/qn /i `&quot;$downloadPath`&quot;&quot; -Wait
    } else {
        Write-Error &quot;Installer not found at: $downloadPath&quot;
    }  
    
    $windowsRegistry = (Get-ItemProperty &quot;HKLM:\SOFTWARE\$softwareName&quot;).Path
    if (-not $windowsRegistry) {
        Write-Error &quot;Software not found in registry. Installation failed.&quot;
    } else {
        Write-Host &quot;Installation successful!&quot;
    }
}
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h5 id="cleanup7zinstaller">
                            <a href="#cleanup7zinstaller">
                                <strong>Step 2.1.3 -</strong> Cleanup 7z Installer
                            </a>
                        </h5>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Delete the 7-zip installer file.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$installerFile = &quot;7z2301-x64.msi&quot;
$softwareFolder = &quot;C:\software&quot;
$downloadPath = Join-Path -Path $softwareFolder -ChildPath $installerFile
    
if (Test-Path -Path $downloadPath) {
    Write-Host &quot;Cleaning up installer file...&quot;
    Remove-Item -Path $downloadPath -Verbose
} else {
    Write-Host &quot;$downloadPath not found!&quot;
    Write-Host &quot;nothing to cleanup.&quot;
}
                </code>
            </pre>
        </div>
    </div>







        



                    <div class="row pt-5">
                        <h3 id="createasmbsharefolder">
                            <a href="#createasmbsharefolder">
                                <strong>Step 3 -</strong> Create a SMB Share folder
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Create a shared space for storing and accessing files.</p>
<p>SMB (Server Message Block) is widely supported and provides a flexible way 
to connect different devices and operating systems for file sharing.</p>
<p>This process includes:
* Enable the File and Printer Sharing service, 
* configure the firewall for Network Discovery, 
* create an SMB share folder, 
* setup appropriate NTFS permissions, and 
* Turn off password protected sharing (optional).</p>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="enablefileandprintersharingformicrosoftnetworksservice">
                            <a href="#enablefileandprintersharingformicrosoftnetworksservice">
                                <strong>Step 3.1 -</strong> Enable File and Printer Sharing for Microsoft Networks service
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Iterate through each network adapter, check the status of the 'ms_server' 
component (File and Printer Sharing), and activate it if necessary. </p>
<p>This step is crucial for setting up network sharing capabilities, 
particularly for the SmbShare folder configuration.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
Get-NetAdapter | ForEach-Object { 
    if (-not ($_ | Get-NetAdapterBinding -ComponentID ms_server).Enabled) {
        $_ | Enable-NetAdapterBinding -ComponentID ms_server
    }
    Get-NetAdapterBinding -ComponentID ms_server
}
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="enablefirewallrulenetworkdiscovery">
                            <a href="#enablefirewallrulenetworkdiscovery">
                                <strong>Step 3.2 -</strong> Enable Firewall Rule Network Discovery
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Enable all Windows Firewall rules associated with the "Network Discovery" 
display group. </p>
<p>This step is essential for allowing the discovery of the computer on a 
network, facilitating the sharing of files and printers, and ensuring 
smooth network communication for tasks like SmbShare operations.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$firewallRuleEnabled = Get-NetFirewallRule -DisplayGroup &quot;Network Discovery&quot; | 
    Where-Object { $_.Enabled -eq &#x27;True&#x27; }

if (-not $firewallRuleEnabled) {
    Enable-NetFirewallRule -DisplayGroup &quot;Network Discovery&quot;
    Write-Host &quot;Network Discovery rules have been enabled.&quot;
} else {
    Write-Host &quot;Network Discovery rules are already enabled.&quot;
}
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="createanewsmbsharefolder">
                            <a href="#createanewsmbsharefolder">
                                <strong>Step 3.3 -</strong> Create a new SMB Share folder
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Create the SMB file share with full access for everyone.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
# Define the folder path and share name
$shareName = &quot;share&quot;
$folderPath = &quot;{automationWorkerWindowsBaseDirectory}\$shareName&quot;

# Check if the folder exists
if (-not (Test-Path $folderPath)) {
    Write-Host &quot;Folder does not exist: $folderPath&quot;
    New-Item -Path $folderPath -ItemType Directory
}

# Check if the share already exists
$shareExists = Get-SmbShare -Name $shareName -ErrorAction SilentlyContinue
if ($shareExists) {
    Write-Host &quot;Share already exists: $shareName&quot;
} else {
    # Create a new file share
    New-SmbShare -Name $shareName -Path $folderPath -FullAccess Everyone
    Write-Host &quot;Share created: $shareName&quot;
}

# Display current shares
Get-SmbShare
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="modifyntfspermissionforsmbsharefolder">
                            <a href="#modifyntfspermissionforsmbsharefolder">
                                <strong>Step 3.4 -</strong> Modify NTFS permission for SmbShare folder
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Modify the NTFS permissions of the SMB share folder to grant full control 
to everyone. </p>
<p>This ensures easy access and management of shared resources on the network.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$shareName = &quot;share&quot;
$folderPath = &quot;{automationWorkerWindowsBaseDirectory}\$shareName&quot;

Write-Host &quot;Modifying NTFS permissions for &#x27;$folderPath&#x27; to grant full access to Everyone...&quot;
$Acl = Get-Acl $folderPath
$AccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule(&quot;Everyone&quot;, &quot;FullControl&quot;, &quot;ContainerInherit,ObjectInherit&quot;, &quot;None&quot;, &quot;Allow&quot;)
$Acl.SetAccessRule($AccessRule)
Set-Acl -Path $folderPath -AclObject $Acl
Write-Host &quot;NTFS permissions modified successfully.&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="turnoffpasswordprotectedsharing">
                            <a href="#turnoffpasswordprotectedsharing">
                                <strong>Step 3.5 -</strong> Turn off Password Protected Sharing
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>If you know the PowerShell commands to turn off 'Password Protected Sharing' 
please update this step and submit a 
<a href="https://github.com/Attune-Automation/Setup-Windows-to-Automate-Operating-System-Installations/pulls">pull request</a>.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
# Reminder for manual action
Write-Host &quot;Manual action required!&quot;
Write-Host &quot;Please turn off &#x27;Password Protected Sharing&#x27; in &#x27;Network and Sharing Center&#x27; -&gt; &#x27;Change advanced sharing settings&#x27;.&quot;
exit 1
                </code>
            </pre>
        </div>
    </div>







                    <div class="row pt-5">
                        <div class="col">
                            <h2>Completed</h2>
                            <p>
                                You have completed this instruction.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

<!-- Download Attune Ad -->

            <div class="toc col-lg-2 px-0">
                <div class="container px-0 pt-3 pl-5">
                    <div class="card border-light mb-3" style="max-width: 18rem;">
                        <div class="card-body attune-ad">
                            <img
                                src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                                alt="Attune - Powered by ServerTribe"
                                class="img-fluid">
                            <p class="card-title mt-3 text-center">
                                <strong>Automate with Attune</strong>
                            </p>
                            <p class="card-text text-center">
                                Download the Attune Community Edition.
                            </p>
                            <p class="text-center">
                                <a href="https://www.servertribe.com/download-attune-registration/"
                                   class="btn btn-primary mt-3">
                                    DOWNLOAD!!!
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

<!-- Join Discord -->

        <div class="row py-5">
            <div class="jumbotron">
              <h1 class="display-4 text-center">
                  Discuss this Project in Discord
              </h1>
              <p class="lead">

                  Join our Discord channel and connect with like-minded individuals who
                  share your passion. Engage in lively discussions, gain valuable insights,
                  and stay updated on the latest trends in our industry. Don't miss out on
                  this opportunity to network, learn, and grow together.
              </p>
              <hr class="my-4 text-center">
                <div class="col px-0">
                  <p class="text-center">
                      Click the link below and become a part of our vibrant community on
                      Discord today!
                  </p>
                  <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://discord.com/invite/3YpJsagqUn"
                       role="button">
                        Join NOW!!!
                    </a>
                  </p>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- Project Footer -->

<footer class="footer fixed-bottom bg-white border-top box-shadow">
      <div class="container px-0">
          <div class="row">
              <div class="col px-0">
                  <a class="my-0 mr-lg-auto"
                     href="https://www.servertribe.com/"
                     target="_blank">
                      <img
                          src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                          alt="Attune - Powered by ServerTribe"
                          class="img-fluid navbar-img">
                  </a>
              </div>
          </div>
      </div>
</footer>


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>


</body>
</html>
